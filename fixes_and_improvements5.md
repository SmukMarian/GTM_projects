# fixes_and_improvements5

## 2. Страница «Управление характеристиками»

### 2.1. Общий стиль и вёрстка страницы

- [x] Привести внешний вид страницы к стилю остальных экранов (карточка проекта и т.п.):
  - Использовать те же карточки/контейнеры (скругление, тень, фон), что и на странице карточки проекта.
  - Внешние отступы между блоками (панель действий, форма добавления секции, список секций) сделать такими же, как между карточками на других страницах.
- [x] Выровнять сетку:
  - Левые края: заголовок «Управление характеристиками», форма добавления секции, карточки секций и таблица полей должны быть по одной вертикали.
  - Высота и вертикальные отступы у заголовков, кнопок, инпутов — выровнять между собой (нет визуального «скакания»).
- [x] Адаптив:
  - На ширинах ~1366px и меньше элементы не должны ломаться в хаотичные строки.
  - При очень широкой ширине ограничить максимальную ширину центрального контейнера, чтобы контент не «растягивался» на весь экран.

### 2.2. Панель действий над характеристиками (верхние кнопки)

- [x] Логически сгруппировать кнопки:
  - Группа 1: `Добавить секцию`.
  - Группа 2: `Выберите шаблон` + `Применить шаблон` + `Сохранить как шаблон` + `Копировать структуру`.
  - Группа 3: `Импорт Excel` + `Экспорт Excel`.
  - Между группами сделать чуть больший горизонтальный отступ.
- [x] Поведение селекта шаблонов:
  - Если шаблонов нет — селект задизейблен, placeholder «Нет сохранённых шаблонов».
  - Пока шаблон не выбран — `Применить шаблон` задизейблена.
- [x] Состояния кнопок:
  - На время долгих операций (`Импорт`, `Экспорт`, применение / сохранение шаблона, копирование структуры):
    - кнопка переходит в состояние loading (спиннер и дизейбл),
    - запрет повторных кликов.
  - При успехе/ошибке показывать toast-уведомление с коротким текстом.
- [x] Текст «Импорт принимает столбцы…»:
  - Переформатировать в компактный абзац или маркированный список, чтобы не было одной очень длинной строки.
  - Текст вынести в локализацию (без хардкода в компоненте).

### 2.3. Форма «Добавление секции»

- [x] Оформить как явную форму:
  - Поля: `Название секции` (обязательное), `Порядок` (select/number, по умолчанию «Авто»).
  - Кнопки: `Добавить секцию` (primary) и `Очистить` (link/ghost).
- [x] Валидация:
  - `Название секции` не может быть пустым, состоять только из пробелов и должно иметь минимальную длину (например, ≥ 3 символов).
  - Названия секций должны быть уникальны в рамках сущности (товара / проекта). При попытке создать дубликат выводить ошибку «Секция с таким названием уже существует».
- [x] UX:
  - Нажатие Enter в поле `Название секции` отправляет форму (если валидна).
  - При успешном создании:
    - форма очищается,
    - фокус возвращается в поле `Название секции`,
    - новая секция добавляется в список ниже без перезагрузки страницы.
  - Кнопка `Очистить` сбрасывает поля и убирает сообщения валидации.

### 2.4. Карточка секции и список полей (блок «ваув»)

#### Карточка секции

- [x] Привести карточку секции к единому виду с карточками на странице проекта:
  - Тот же фон, скругления и тень.
  - Внутренний `padding` по периметру, чтобы таблица не прилегала вплотную к границе.
- [x] Заголовок секции:
  - Отображать название секции крупнее и жирнее, ниже — `Порядок: N` более мелким текстом.
  - Добавить визуальный разделитель (тонкая линия или дополнительный отступ) между заголовком и панелью действий (`Редактировать`, `+ Поле`, `Вверх`, `Вниз`, `Удалить`).

#### Действия с секцией

- [x] Кнопки `Вверх`/`Вниз`:
  - При достижении верхней/нижней позиции — дизейблить соответствующую кнопку.
  - После смены порядка обновлять сортировку секций без перезагрузки страницы.
- [x] Кнопка `Удалить`:
  - Запрашивать подтверждение (модалка) с текстом, что будут удалены все поля секции.
- [x] Режим редактирования секции:
  - `Редактировать` переводит заголовок в инпут (название секции) + при необходимости поле `Порядок`.
  - Добавить кнопки `Сохранить` и `Отмена` в этом режиме.
  - Применить те же правила валидации, что и при создании секции.

#### Таблица полей

- [x] Выровнять таблицу визуально:
  - Заголовки столбцов (`Label RU`, `Label EN`, `Value RU`, `Value EN`, `Тип`, `Действия`) выровнять по вертикали, задать одинаковые отступы сверху/снизу.
  - Добавить внутренний отступ слева/справа, чтобы текст и инпуты не «липли» к границе ячейки.
  - Внешние края таблицы не должны примыкать к границе карточки секции — добавить `padding`.
- [x] Привести поведение ячеек к единому виду:
  - Сейчас в таблице смешаны обычные текстовые значения и инпуты — нужно определить одну модель:
    - либо все значения редактируются inline (ячейки всегда инпуты/селекты),
    - либо по умолчанию отображается текст, а при нажатии `Редактировать` строка переходит в режим редактирования (инпуты/селекты только в этой строке).
  - Выбрать один вариант и реализовать его во всех строках одинаково.
- [x] Работоспособность `Редактировать` в строке:
  - По клику `Редактировать`:
    - строка переходит в режим редактирования (Label/Value/Тип — инпуты или соответствующие компоненты),
    - кнопка `Редактировать` заменяется на `Сохранить` и `Отмена`.
  - `Сохранить` отправляет изменения на сервер, при успехе переводит строку обратно в режим просмотра.
  - `Отмена` возвращает исходные значения без сохранения.
- [x] Колонка `Тип`:
  - Использовать селект с доступными типами (`text`, `number`, `select`, `checkbox`, `other`…), значения — строго из списка, никаких произвольных строк.
  - В режиме просмотра выводить человекочитаемое название типа (локализованное).
- [x] Checkbox-поля:
  - Привести отображение чекбоксов к единому стилю (та же высота и выравнивание по центру строки).
  - При клике по чекбоксу значение сохраняется, либо:
    - сохраняется сразу по клику, с анимацией/индикатором сохранения,
    - или изменяется только в режиме редактирования строки — выбрать один вариант и использовать везде одинаково.
- [x] Кнопки в колонке `Действия`:
  - Выстроить одну и ту же последовательность во всех строках: `Редактировать` | стрелки `↑`/`↓` | `Удалить`.
  - Выравнивание по центру строки, одинаковые отступы между кнопками.
  - Дизейблить стрелки `↑`/`↓` по тем же правилам, что и для секций (нет перемещения вверх/вниз за границы списка).

### 2.5. Блок «Новое поле» (создание поля в секции)

- [x] Показ/скрытие:
  - `+ Поле` открывает блок добавления поля **только** в выбранной секции.
  - Одновременно может быть открыт только один блок «Новое поле» — при открытии нового предыдущий закрывается.
- [x] Структура формы:
  - Поля: `Label RU` (обяз.), `Label EN` (опц.), `Тип поля` (обяз.), при необходимости — дополнительные настройки.
- [x] Валидация:
  - `Label RU` не пустой, без одних пробелов.
  - Если `Label EN` заполнен — тоже проверять минимальную длину.
  - `Тип поля` обязательно выбран.
- [x] Поведение:
  - `Создать поле` — отправка запроса, кнопка и форма уходят в состояние loading на время запроса.
  - При успехе:
    - форма очищается,
    - таблица полей обновляется,
    - блок либо остаётся открытым для следующего поля, либо закрывается — выбрать один вариант и использовать везде.
  - `Отмена` закрывает блок и сбрасывает введённые данные.

### 2.6. Импорт / экспорт Excel

- [x] Импорт:
  - Проверять наличие обязательных столбцов: `Секция`, `Label RU`, `Label EN`, `Value RU`, `Value EN`, `Тип поля`.
  - Обрабатывать необязательные столбцы `Порядок секции`, `Порядок поля`:
    - если не переданы — использовать авто-порядок.
  - Определить и реализовать стратегию при совпадении секции и label с уже существующими:
    - либо обновление существующих полей,
    - либо создание новых, но с явной логикой (например, добавлять суффикс).
  - После импорта показывать краткий отчёт: сколько секций/полей создано, обновлено, пропущено.
- [x] Экспорт:
  - Экспортировать текущую структуру в том же формате, который принимает импорт.
  - Учитывать фактический порядок секций и полей.
  - Генерировать осмысленное имя файла (например, с датой и идентификатором проекта).

### 2.7. Ошибки, уведомления, i18n

- [x] Все надписи и сообщения (подсказки, ошибки, названия столбцов/кнопок) вынести в систему локализации.
- [x] Реализовать клиентскую валидацию до отправки запроса + корректную обработку ошибок с сервера:
  - сетевые ошибки,
  - ошибки валидации с бэка.
- [x] При ошибках:
  - показывать уведомление (toast) с понятным текстом,
  - откатывать визуальное состояние (например, не оставлять строку в режиме редактирования при неуспешном сохранении).
- [x] Обеспечить нормальную навигацию с клавиатуры:
  - логичный порядок перехода по Tab,
  - фокус возвращается на понятный элемент после успешного действия.

## 3. Переключатель темы в шапке

- [x] Убрать текстовые подписи из отображения выбранной темы в шапке:
  - В верхнем баре отображаются только иконки темы без текста (`Светлая`, `Системная`, `Тёмная`).
  - На месте нынешней надписи «Светлая» оставить только кружок-иконку текущей темы.
- [x] Внутри дропдауна:
  - Оставить только иконки для выбора темы, без текстовых подписей.
  - Добавить `title`/tooltip при наведении (например, «Светлая тема», «Системная тема», «Тёмная тема»), чтобы пользователь всё равно понимал, что выбирает.
- [x] Проверить адаптивность:
  - На узких экранах иконка темы не должна «ломать» верстку шапки.
- [x] Состояния:
  - Текущая выбранная тема визуально подсвечивается (фон/рамка/иконка), но без текстового лейбла.

## 4. Карточка проекта — блок с фото

- [x] Исправить растягивание фонового изображения:
  - Настроить стиль так, чтобы изображение не деформировалось по вертикали/горизонтали.
  - Использовать поведение "вписать" или "обрезать по контейнеру" (аналог `object-fit: contain` или `cover`) вместо растягивания.
- [x] Ограничить пропорции контейнера:
  - Зафиксировать разумное соотношение сторон для блока фото (например, приблизительно вертикальный прямоугольник, как сейчас на макете).
  - На разных высотах/разрешениях блок не должен визуально «раздуваться» или «сжиматься» слишком сильно.
- [x] Выровнять блок с фото с остальными карточками:
  - Использовать те же отступы и скругления, что и у остальных блоков карточки проекта.
  - Проверить, что тень и фон блока совпадают с остальными карточками.
- [x] Галерея:
  - При наличии нескольких изображений обеспечить:
    - корректное масштабирование всех миниатюр,
    - отсутствие «обрезания» важных частей,
    - одинаковые отступы между фото.

## 5. Фавикон

- [x] Установить единый фавикон для всего приложения:
  - Использовать иконку Projects Tracker (как в логотипе в шапке) в качестве фавикона.
- [x] Обновить `<link rel="icon">` во всех шаблонах/точках входа:
  - Для SPA-приложения — убедиться, что фавикон подключён в основном HTML-шаблоне (например, `public/index.html` или аналог).
  - Для SSR/мультистраничных конфигураций — убедиться, что фавикон прописан во всех layout’ах.
- [x] Проверить отображение фавикона:
  - В основных браузерах (Chrome, Edge, Firefox, Safari).
  - Во вкладках, списке закладок и на экране PWA (если используется).
- [x] Удалить или обновить старые/неиспользуемые иконки, чтобы не было конфликта между разными вариантами.

---

## 3. Доработки после первой итерации

### 3.1. Toast-уведомления

- [x] Привести позиционирование всех toast-уведомлений на странице «Управление характеристиками» к одному варианту:
  - Для этой страницы **всегда** показывать toast в правом нижнем углу (`bottom-right`).
  - Проверить все сценарии: создание/редактирование/удаление секции, поля, импорт/экспорт, ошибки загрузки.
  - Убедиться, что позиция не переопределяется глобальными настройками/другими страницами.

---

### 3.2. Поле «Название секции» (форма создания)

- [x] Применить к инпуту «Название секции» те же стили, что используются в остальных формах приложения:
  - Та же высота, скругления, цвет рамки и фон, что и у инпутов в карточке проекта.
  - Одинаковый `padding` внутри поля, чтобы текст не «лип» к краям.
  - При фокусе — такой же эффект (цвет рамки/тени), как у других инпутов.
- [x] Проверить, что ширина поля согласована с сеткой:
  - Левая и правая границы поля выровнены с границами карточек секций ниже.
- [x] Проверить placeholder:
  - Текст «Например: Основные параметры» отображается серым и не конфликтует с основным стилем.

---

### 3.3. Отображение секций (баг: показываются только после добавления новой)

- [x] Исправить логику загрузки списка секций:
  - При заходе на страницу должен выполняться запрос на получение всех существующих секций.
  - Список секций должен отображаться **без необходимости** создавать новую.
- [x] Проверить логику работы со стейтом:
  - Убедиться, что первая загрузка не зависит от успешного ответа на создание секции.
  - После создания/удаления/редактирования секции:
    - либо обновлять локальный стейт по месту,
    - либо перезапрашивать список секций — но в обоих случаях не ломать уже загруженные данные.
- [x] Добавить корректное отображение пустого состояния:
  - Если секций нет — показывать текст «Секции пока не созданы» (или аналогичный) вместо пустого пространства.

---

### 3.4. Выпадающий список «Выберите шаблон»

- [x] Привести селект «Выберите шаблон» к нормальному виду:
  - Стилизовать в том же компоненте/стиле, что и остальные селекты в проекте (как селект `Тип` в таблице).
  - Ширина селекта — достаточная для отображения текста, но без лишнего пустого пространства.
- [x] Проверить корректность открытия списка:
  - Список шаблонов не обрезается и не «уползает» за экран.
  - `z-index` достаточно высокий, чтобы список не перекрывался другими блоками.
- [x] Поведение:
  - Пока шаблон не выбран — текст «Выберите шаблон» (placeholder) и кнопка «Применить шаблон» задизейблена.
  - При выборе шаблона — отображается его название, `Применить шаблон` становится активной.

---

### 3.5. Режим ввода данных в таблице (вернуть удобный inline-режим)

- [x] Убрать необходимость включать отдельный режим редактирования для стандартных полей:
  - Поля `Value RU`, `Value EN` и, при необходимости, часть других колонок должны быть **редактируемыми сразу**, как только пользователь кликает в ячейку.
  - Не требовать нажатия `Редактировать` перед вводом.
- [x] Логика сохранения:
  - При изменении значений строка помечается как «изменённая» (dirty).
  - В строке появляется набор кнопок `Сохранить` / `Отмена` **только когда есть изменения**.
  - `Сохранить` отправляет изменения на сервер и возвращает строку в обычный вид.
  - `Отмена` откатывает все изменения в строке к последнему сохранённому состоянию.
- [x] Дополнительно:
  - Либо скрыть кнопку `Редактировать`, либо оставить её как альтернативный вход в режим (но при этом всё равно разрешать ввод при клике по ячейке).
  - При нажатии Enter внутри инпута:
    - сохранять строку (эквивалент `Сохранить`),
    - либо переходить к следующей ячейке — выбрать один вариант и использовать везде единообразно.

---

### 3.6. Выход полей за пределы таблицы

- [x] Починить вёрстку таблицы, чтобы контент не вылезал наружу:
  - Задать `table-layout: fixed` и фиксированные/относительные ширины колонок, чтобы таблица не растягивалась хаотично.
  - Для инпутов внутри ячеек:
    - `width: 100%` относительно ячейки,
    - без внешних `margin`, только внутренний `padding`.
- [x] Проверить поведение при длинных значениях:
  - Текст/значения должны обрезаться (ellipsis) или переноситься строкой **внутри** ячейки, а не выезжать за границы.
- [x] Проверить все типы полей:
  - Текстовые инпуты,
  - numeric-инпуты со стрелками,
  - селект `Тип`,
  - чекбоксы.
  Все они должны оставаться внутри ячейки и не ломать высоту строки.

---

### 3.7. Отступы между секциями

- [x] Добавить вертикальные интервалы между карточками секций:
  - Между секциями сделать `margin-top`/`margin-bottom` или `gap` в контейнере (уровня 12–16px, в соответствии со стилем проекта).
  - Верхний край самой первой секции выровнять по вертикали с остальными блоками страницы (форма добавления секции, заголовок).
- [x] Убедиться, что отступы:
  - одинаковы для всех секций,
  - не исчезают при добавлении/удалении секции.

---

### 3.8. Переключатель темы (иконки без лишнего места)

- [x] Подогнать размеры кнопки переключателя темы в шапке:
  - Ширина и высота кнопки должны соответствовать размеру иконки + стандартный горизонтальный/вертикальный `padding`.
  - Кнопка не должна выглядеть как широкая текстовая кнопка с одной иконкой.
- [x] Поправить пункты дропдауна:
  - Высота строки — компактная, ориентированная на иконку (например, 32–40px).
  - Содержимое выровнено по центру (иконка по центру строки).
  - Ширина выпадающего списка подогнана под иконки, без лишнего пустого места справа.
- [x] Проверить адаптивность:
  - На маленьких экранах переключатель темы не должен раздвигать меню и не ломать выравнивание других кнопок в шапке.

---

## 4. Карточка проекта — правая колонка с фото (уточнение дизайна)

### 4.1. Общий контейнер справа

- [x] Сделать справа **не «растянутый» на всю высоту блок**, а компактную карточку под размер фото и кнопок:
  - Внешний правый столбец остаётся как колонка layout’а.
  - Внутри него — отдельная карточка (фон + тень + скругления), высота которой определяется содержимым (обложка + кнопки).
- [x] Отцентрировать эту карточку в правой колонке по горизонтали:
  - Карточка не прижимается к левому или правому краю, а находится по центру столбца.
  - По вертикали карточка прижимается к верху (как сейчас), чтобы не «плавала» по середине экрана.

### 4.2. Контейнер с фото (обложкой)

- [x] Контейнер для изображения не должен растягиваться «во весь рост»:
  - Убрать фиксированную высоту/`min-height`, из-за которой вокруг фото появляется большой серый пустой блок.
  - Высота контейнера должна зависеть от реального размера изображения + фиксированный внутренний отступ (например, 16px со всех сторон).
- [x] Сохранить аккуратный серый фон вокруг изображения:
  - Ровный одинаковый отступ сверху/снизу/слева/справа.
  - Без огромных «полей» сверху и снизу, как сейчас.
- [x] Отображение самого изображения:
  - Использовать `object-fit: contain` или аналог, чтобы картинка целиком помещалась в контейнер без искажений, но **не** порождала лишнюю серую область.
  - Изображение центрировать внутри контейнера по горизонтали и вертикали.
- [x] Если используется несколько фотографий/галерея:
  - Между отдельными фото внутри контейнера не должно быть большого серого «пропасти».
  - Отступы между миниатюрами/кадрами — разумные (например, 8–12px), одинаковые с двух сторон.

### 4.3. Кнопки под фото

- [x] Блок с кнопками (`Загрузить / заменить`, `Снять обложку`, `Галерея`) оставить **отдельным** от серой зоны изображения:
  - Кнопки располагаются под карточкой с фото, с верхним отступом (например, 12–16px).
  - Не допускать, чтобы кнопки «прибивались» к самому низу общего правого блока — их позиция должна зависеть только от высоты карточки с фото.
- [x] Выровнять кнопки по сетке:
  - Первая строка: `Загрузить / заменить` + `Снять обложку` в одной линии.
  - Ниже — отдельная кнопка `Галерея` с небольшим отступом сверху.

### 4.4. Адаптивность и единый стиль

- [x] Проверить поведение правой карточки на разных высотах/ширинах:
  - На маленьких экранах карточка не должна растягиваться по высоте и не должна «липнуть» к низу.
  - При отсутствии фото контейнер под фото занимает минимальную высоту и показывает placeholder (иконка + текст) без огромного серого поля.
- [x] Убедиться, что:
  - фон, скругления и тень у правой карточки совпадают со стилем остальных карточек в проекте,
  - отступы сверху/снизу у правой карточки согласованы с отступами других блоков карточки проекта.
